<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <link rel="stylesheet" th:href="@{/css/vendor/font-awesome.min.css}"/>
  <link rel="stylesheet" th:href="@{/css/vendor/Pe-icon-7-stroke.css}" />

  <!-- Plugin CSS (Global Plugins Files) -->
  <link rel="stylesheet" th:href="@{/css/plugins/animate.min.css}">
  <link rel="stylesheet" th:href="@{/css/plugins/jquery-ui.min.css}">
  <link rel="stylesheet" th:href="@{/css/plugins/swiper-bundle.min.css}">
  <link rel="stylesheet" th:href="@{/css/plugins/nice-select.css}">
  <link rel="stylesheet" th:href="@{/css/plugins/magnific-popup.min.css}"/>

  <!-- Style CSS -->
  <link rel="stylesheet" th:href="@{/css/style.css }">
  <link rel="stylesheet" th:href="@{/css/project.css }">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
<div class="title">공지사항</div>
<!-- Begin 게시판영역 -->

<div id="projectNoticeList">
<table class="basic-table" id="project-qna-table projectNoticeList" align="center" style="width: 100%">
  <tr>
    <th>번호</th>
    <th>제목</th>
    <th>작성일</th>
    <th>조회수</th>
  </tr>
  <tr th:each="project : ${ projectNoticeList }" class="noticeList" id="noticeList">
<!--    <input type="hidden" th:text="${ project.projectNoticeNo }">-->
    <td th:text="${ project.projectNoticeNo }"></td>
    <td th:text="${ project.projectNoticeTitle }"></td>
    <td th:text="${ project.registDate }"></td><!--이름을 넣어야하는데..어떻게 들고오나....수바-->
    <td th:text="${ project.projectNoticeCount }"></td>
  </tr>
</table>
</div>

<div class="notice-wrap" id="projectNoticeDetail" style="display:none">
    <div class="cont-div">
        <table>
            <tr class="title" th:each="notice : ${ projectNoticeDetail }">
                <input class="projectNo" id="projectNo" type="hidden" th:value="${ notice.projectNo }">
                <td class="title" colspan="2" th:text="${ notice.projectNoticeTitle }">제목</td>
            </tr>
            <tr th:each="notice : ${ projectNoticeDetail }">
                <td class="date" th:text="${ notice.registDate }">작성일</td>
            </tr>
            <tr th:each="notice : ${ projectNoticeDetail }">
                <td class="content" colspan="2" th:text="${ notice.projectNoticeContent }">내용</td>
            </tr>
        </table>
        <button class="basic-btn small-btn btn3 back" id="back">목록보기</button>
    </div>
</div>

  </main>
</div>
<!--<td th:te></td>-->
<div id="pagination" class="pagenumbers" align="center">
  <!-- 맨 앞으로 이동 -->
  <button th:onclick="'location.href=\'/project/notice/list/'+ @{${projectNo}} +'?page=' + @{${paging.startPage}} + '\''"
          th:disabled="${ projectNoticeList.first }" class="paging-btn first"><<</button>

  <!-- 이전 페이지로 이동 -->
  <button th:onclick="'location.href=\'/project/notice/list/'+ @{${projectNo}} +'?page=' + @{${paging.currentPage - 1}} + '\''"
          th:disabled="${ projectNoticeList.first }" class="paging-btn prev"><</button>

  <!-- 숫자 버튼-->
  <th:block th:each="page : ${#numbers.sequence(paging.startPage, paging.endPage)}">
    <button th:onclick="'location.href=\'/project/notice/list/'+ @{${projectNo}} +'?page=' + @{${page}} + '\''"
            th:text="${ page }" th:disabled="${ paging.currentPage eq page}" class="paging-btn"></button>
  </th:block>

  <!-- 다음 페이지로 이동 -->
  <button th:onclick="'location.href=\'/project/notice/list/'+ @{${projectNo}} +'?page=' + @{${paging.currentPage + 1}} + '\''"
          th:disabled="${ projectNoticeList.last}" class="paging-btn next">></button>

  <!-- 맨 마지막으로 이동-->
  <button th:onclick="'location.href=\'/project/notice/list/'+ @{${projectNo}} +'?page=' + @{${paging.endPage}} + '\''"
          th:disabled="${ projectNoticeList.last }" class="paging-btn last">>></button>
</div>
</div>
<script>

  /* 공지사항 목록 조회 */    // $("#notice").click(function() {
  console.log("도착?");
  const projectNo = 2;

  $("#back").click(function() {
    // const projectNo =
    location.href='/project/notice/list/' + projectNo;
  });

  function projectNoticeData(projectNoticeNo, projectNoticeTitle, projectNoticeCount, registDate, projectNo) {

    return {projectNoticeNo, projectNoticeTitle, projectNoticeCount, registDate, projectNo};
  }

  function findProjectNoticeList() {

    fetch('/project/notice/list/{projectNo}').then(resonse => {
      if (resonse.ok) {
        return resonse.json();
      }
    }).then(json => {
      let html = '';

      if (!json.length) {
        alert("암것도 없음");
        console.log("암것도 없음");
        html = '<td colspan="5">등록된 게시글이 없습니다.</td>';
      } else {
        json.forEach((projectNoticeData, idx) => {
          console.log("게시글있음");

        });
      }
    });
  }

  /* 목록 눌러서 상세조회로 이동 */
  /* 게시글을 클릭하면 해당 게시글 번호로 이동한다. */
  if(document.querySelectorAll("#noticeList td")) {
    const $tds = document.querySelectorAll("#noticeList td");
    for( let i = 0; i < $tds.length; i++) {

      $tds[i].onclick = function() {
        const projectNoticeNo = this.parentNode.children[0].innerText;
        console.log(projectNoticeNo);

          // document.getElementById("projectNoticeList").style.display = "none";
          // document.getElementById("pagination").style.display = "none";
          // document.getElementById("projectNoticeDetail").style.display = "block";

          location.href = '/project/notice/detail/' + projectNoticeNo;

      }
    }
  }

  // const projectNo = 2;
  //
  // function projectNoticeData(projectNoticeNo, projectNoticeTitle, projectNoticeCount, registDate) {
  //
  //     return {projectNoticeNo, projectNoticeTitle, projectNoticeCount, registDate};
  // }
  //
  // function findProjectNoticeList() {
  //     fetch('/project/notice/list/{projectNo}').then(resonse => {
  //         if (resonse.ok) {
  //             return resonse.json();
  //         }
  //     }).then(json => {
  //         let html = '';
  //
  //         if (!json.length) {
  //             // alert("암것도 없음");
  //             // console.log("암것도 없음");
  //             html = '<td colspan="5">등록된 게시글이 없습니다.</td>';
  //         } else {
  //             json.forEach((projectNoticeData, idx) => {
  //                 // console.log("게시글있음");
  //             });
  //         }
  //     });
  //
  // }


  /* 공지사항 상세조회 */


</script>
<script th:src="@{ /js/vendor/bootstrap.bundle.min.js }"></script>
<script th:src="@{ /js/vendor/jquery-3.5.1.min.js }"></script>
<script th:src="@{ /js/vendor/jquery-migrate-3.3.0.min.js }"></script>
<script th:src="@{ /js/vendor/modernizr-3.11.2.min.js }"></script>
<script th:src="@{ /js/vendor/jquery.waypoints.js }"></script>

<!--Plugins JS-->
<script th:src="@{ /js/plugins/wow.min.js }"></script>
<script th:src="@{ /js/plugins/jquery-ui.min.js }"></script>
<script th:src="@{ /js/plugins/swiper-bundle.min.js }"></script>
<script th:src="@{ /js/plugins/jquery.nice-select.js }"></script>
<script th:src="@{ /js/plugins/parallax.min.js }"></script>
<script th:src="@{ /js/plugins/jquery.magnific-popup.min.js }"></script>
</body>
</html>